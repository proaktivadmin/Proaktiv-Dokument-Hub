# FRONTEND SPECIFICATION - V2.7 Document Hub

**Generated by:** Frontend Architect Agent  
**Date:** 2026-01-16  
**Phase:** 2.7 (Template Content Editing & Settings Persistence)

---

## EXECUTIVE SUMMARY

This specification extends the V2.6 frontend to integrate with the new backend APIs for:
1. **Template Content Editing** - Save edited HTML content from Monaco editor
2. **Template Settings Management** - Persist Vitec metadata and layout settings
3. **Dashboard Stats Integration** - Use real backend data instead of mock
4. **Thumbnail Generation** - Trigger static thumbnail generation

### Current State (V2.6)
- ✅ 4-tab document viewer (Preview, Code, Settings, Simulator)
- ✅ Live document preview thumbnails on template cards
- ✅ A4 page break visualization
- ✅ Simulator with persistent test data
- ✅ Monaco code editor (read-only)
- ✅ Settings panel UI (not wired to backend)
- ✅ Shelf library with wrapped grid layout

### Target State (V2.7)
- Save button in Code tab triggers `PUT /api/templates/{id}/content`
- Save button in Settings tab triggers `PUT /api/templates/{id}/settings`
- Dashboard fetches stats from `GET /api/dashboard/stats`
- Optional: Generate thumbnail button triggers `POST /api/templates/{id}/thumbnail`

---

## T1: TYPE DEFINITIONS

### File: `frontend/src/types/v2.ts`

Update existing types and add new ones for V2.7 API integration.

```typescript
/**
 * V2.7 Type Definitions
 * Extends existing types with new backend API support
 */

import type { Template } from './index';

// ============================================================================
// TEMPLATE CONTENT & SETTINGS
// ============================================================================

/**
 * Extended template type with V2.7 Vitec metadata fields
 */
export interface TemplateWithMetadata extends Template {
  // Channel and Type
  channel: TemplateChannel;
  template_type: TemplateType;
  
  // Receiver
  receiver_type?: ReceiverType;
  receiver?: Receiver;
  extra_receivers: string[];
  
  // Filtering/Categorization
  phases: Phase[];
  assignment_types: string[];
  ownership_types: OwnershipType[];
  departments: string[];
  
  // Email
  email_subject?: string;
  
  // Layout References
  header_template_id?: string;
  footer_template_id?: string;
  
  // Margins (in cm)
  margin_top?: number;
  margin_bottom?: number;
  margin_left?: number;
  margin_right?: number;
  
  // Thumbnail
  preview_thumbnail_url?: string;
}

export type TemplateChannel = 'pdf' | 'email' | 'sms' | 'pdf_email';
export type TemplateType = 'Objekt/Kontakt' | 'System';
export type ReceiverType = 'Egne/kundetilpasset' | 'Systemstandard';
export type Receiver = 'Selger' | 'Kjøper' | 'Megler' | 'Bank' | 'Forretningsfører';
export type Phase = 'Oppdrag' | 'Markedsføring' | 'Visning' | 'Budrunde' | 'Kontrakt' | 'Oppgjør';
export type OwnershipType = 'Bolig' | 'Aksje' | 'Tomt' | 'Næring' | 'Hytte';

/**
 * Request payload for saving template content
 */
export interface SaveTemplateContentRequest {
  content: string;
  change_notes?: string;
  auto_sanitize?: boolean;
}

/**
 * Response from saving template content
 */
export interface SaveTemplateContentResponse {
  id: string;
  version: number;
  content_hash: string;
  merge_fields_detected: number;
  previous_version_id?: string;
}

/**
 * Request payload for updating template settings
 */
export interface UpdateTemplateSettingsRequest {
  channel?: TemplateChannel;
  template_type?: TemplateType;
  receiver_type?: ReceiverType;
  receiver?: Receiver;
  extra_receivers?: string[];
  phases?: Phase[];
  assignment_types?: string[];
  ownership_types?: OwnershipType[];
  departments?: string[];
  email_subject?: string;
  header_template_id?: string;
  footer_template_id?: string;
  margin_top?: number;
  margin_bottom?: number;
  margin_left?: number;
  margin_right?: number;
}

/**
 * Response from updating template settings
 */
export interface UpdateTemplateSettingsResponse extends TemplateWithMetadata {
  updated_at: string;
}

/**
 * Response from generating thumbnail
 */
export interface GenerateThumbnailResponse {
  thumbnail_url: string;
  width: number;
  height: number;
}

// ============================================================================
// DASHBOARD STATS
// ============================================================================

/**
 * Dashboard statistics from backend
 */
export interface DashboardStatsV2 {
  total: number;
  published: number;
  draft: number;
  archived: number;
  downloads: number;
  recent_uploads: RecentUploadV2[];
}

export interface RecentUploadV2 {
  id: string;
  title: string;
  created_at: string;
}

// ============================================================================
// SHELF GROUPING
// ============================================================================

/**
 * Shelf grouping configuration
 */
export type ShelfGroupBy = 'channel' | 'category' | 'status' | 'phase';

/**
 * Grouped templates for shelf display
 */
export interface ShelfGroup {
  id: string;
  label: string;
  icon?: React.ReactNode;
  templates: TemplateWithMetadata[];
  isCollapsed: boolean;
}

/**
 * Result of grouping templates
 */
export interface GroupedTemplates {
  groups: ShelfGroup[];
  totalCount: number;
}
```

---

## T2: API CLIENT EXTENSIONS

### File: `frontend/src/lib/api/template-settings.ts`

New API client for template content and settings operations.

```typescript
/**
 * Template Settings API Client
 * Handles content editing and settings persistence
 */

import axios from 'axios';
import type {
  SaveTemplateContentRequest,
  SaveTemplateContentResponse,
  UpdateTemplateSettingsRequest,
  UpdateTemplateSettingsResponse,
  GenerateThumbnailResponse,
} from '@/types/v2';

const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || '';

const api = axios.create({
  baseURL: `${API_BASE_URL}/api`,
});

export const templateSettingsApi = {
  /**
   * Save template HTML content
   * Creates a version snapshot before saving
   */
  async saveContent(
    templateId: string,
    payload: SaveTemplateContentRequest
  ): Promise<SaveTemplateContentResponse> {
    const { data } = await api.put<SaveTemplateContentResponse>(
      `/templates/${templateId}/content`,
      payload
    );
    return data;
  },

  /**
   * Update template settings (Vitec metadata)
   */
  async updateSettings(
    templateId: string,
    payload: UpdateTemplateSettingsRequest
  ): Promise<UpdateTemplateSettingsResponse> {
    const { data } = await api.put<UpdateTemplateSettingsResponse>(
      `/templates/${templateId}/settings`,
      payload
    );
    return data;
  },

  /**
   * Get template settings
   */
  async getSettings(templateId: string): Promise<UpdateTemplateSettingsResponse> {
    const { data } = await api.get<UpdateTemplateSettingsResponse>(
      `/templates/${templateId}/settings`
    );
    return data;
  },

  /**
   * Generate static thumbnail for template
   * Returns 501 if Playwright not installed
   */
  async generateThumbnail(templateId: string): Promise<GenerateThumbnailResponse> {
    const { data } = await api.post<GenerateThumbnailResponse>(
      `/templates/${templateId}/thumbnail`
    );
    return data;
  },
};
```

### File: `frontend/src/lib/api/dashboard.ts`

New API client for dashboard statistics.

```typescript
/**
 * Dashboard API Client
 * Fetches real-time statistics from backend
 */

import axios from 'axios';
import type { DashboardStatsV2 } from '@/types/v2';

const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || '';

const api = axios.create({
  baseURL: `${API_BASE_URL}/api`,
});

export const dashboardApi = {
  /**
   * Get dashboard statistics
   */
  async getStats(): Promise<DashboardStatsV2> {
    const { data } = await api.get<DashboardStatsV2>('/dashboard/stats');
    return data;
  },
};
```

### Update: `frontend/src/lib/api.ts`

Export the new API clients.

```typescript
// Add to existing exports
export { templateSettingsApi } from './api/template-settings';
export { dashboardApi } from './api/dashboard';
```

---

## T3: COMPONENT UPDATES

### Update: `frontend/src/components/templates/TemplateDetailSheet.tsx`

Wire up the Save button in Code tab and Settings tab.

**Changes:**
1. Add state for save status (saving, success, error)
2. Wire up `onSave` callback in CodeEditor to call `templateSettingsApi.saveContent`
3. Wire up Settings panel save to call `templateSettingsApi.updateSettings`
4. Show toast notifications on success/error
5. Refetch template data after successful save

```typescript
// Add imports
import { templateSettingsApi } from "@/lib/api";
import { useToast } from "@/hooks/use-toast";

// Add state
const [isSavingContent, setIsSavingContent] = useState(false);
const [isSavingSettings, setIsSavingSettings] = useState(false);
const { toast } = useToast();

// Update CodeEditor onSave callback
<CodeEditor
  value={originalContent}
  onChange={(newContent) => {
    setOriginalContent(newContent);
    setProcessedContent(null);
    setTestDataEnabled(false);
  }}
  language="html"
  theme="vs-dark"
  onSave={async (value) => {
    if (!template) return;
    
    setIsSavingContent(true);
    try {
      const result = await templateSettingsApi.saveContent(template.id, {
        content: value,
        auto_sanitize: true,
      });
      
      toast({
        title: "Innhold lagret",
        description: `Versjon ${result.version} opprettet. ${result.merge_fields_detected} flettekoder funnet.`,
      });
      
      // Reload content to get updated version
      await loadContent(template.id);
    } catch (error) {
      toast({
        title: "Feil ved lagring",
        description: error instanceof Error ? error.message : "Kunne ikke lagre innhold",
        variant: "destructive",
      });
    } finally {
      setIsSavingContent(false);
    }
  }}
  isSaving={isSavingContent}
/>

// Update Settings panel onSave
<TemplateSettingsPanel
  templateId={template.id}
  onSave={async (settings: TemplateSettings) => {
    setIsSavingSettings(true);
    try {
      await templateSettingsApi.updateSettings(template.id, settings);
      
      toast({
        title: "Innstillinger lagret",
        description: "Malinnstillingene er oppdatert.",
      });
    } catch (error) {
      toast({
        title: "Feil ved lagring",
        description: error instanceof Error ? error.message : "Kunne ikke lagre innstillinger",
        variant: "destructive",
      });
    } finally {
      setIsSavingSettings(false);
    }
  }}
  isSaving={isSavingSettings}
/>
```

### Update: `frontend/src/components/editor/CodeEditor.tsx`

Add `isSaving` prop to show loading state on save button.

```typescript
interface CodeEditorProps {
  value: string;
  onChange: (value: string) => void;
  language?: string;
  theme?: string;
  onSave?: (value: string) => Promise<void>;
  isSaving?: boolean; // NEW
}

// Update save button
<Button
  size="sm"
  onClick={handleSave}
  disabled={isSaving}
  className="gap-2"
>
  {isSaving ? (
    <>
      <Loader2 className="h-4 w-4 animate-spin" />
      Lagrer...
    </>
  ) : (
    <>
      <Save className="h-4 w-4" />
      Lagre (Ctrl+S)
    </>
  )}
</Button>
```

### Update: `frontend/src/components/templates/TemplateSettingsPanel.tsx`

Add `isSaving` prop and update save button.

```typescript
interface TemplateSettingsPanelProps {
  templateId: string;
  onSave: (settings: TemplateSettings) => Promise<void>;
  isSaving?: boolean; // NEW
}

// Update save button
<Button
  onClick={handleSave}
  disabled={isSaving}
  className="w-full gap-2"
>
  {isSaving ? (
    <>
      <Loader2 className="h-4 w-4 animate-spin" />
      Lagrer...
    </>
  ) : (
    <>
      <Save className="h-4 w-4" />
      Lagre innstillinger
    </>
  )}
</Button>
```

### Update: `frontend/src/app/page.tsx` (Dashboard)

Replace mock data with real API call.

```typescript
// Add imports
import { dashboardApi } from "@/lib/api";
import { useEffect, useState } from "react";

// Add state
const [stats, setStats] = useState<DashboardStatsV2 | null>(null);
const [isLoading, setIsLoading] = useState(true);
const [error, setError] = useState<string | null>(null);

// Fetch stats on mount
useEffect(() => {
  const fetchStats = async () => {
    setIsLoading(true);
    setError(null);
    try {
      const data = await dashboardApi.getStats();
      setStats(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : "Kunne ikke laste statistikk");
    } finally {
      setIsLoading(false);
    }
  };

  fetchStats();
}, []);

// Update stats cards to use real data
{isLoading ? (
  <Skeleton className="h-24" />
) : error ? (
  <div className="text-red-600 text-sm">{error}</div>
) : (
  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <StatCard
      title="Totalt maler"
      value={stats?.total ?? 0}
      icon={<FileText className="h-5 w-5" />}
    />
    <StatCard
      title="Publiserte"
      value={stats?.published ?? 0}
      icon={<CheckCircle className="h-5 w-5" />}
    />
    <StatCard
      title="Utkast"
      value={stats?.draft ?? 0}
      icon={<Clock className="h-5 w-5" />}
    />
    <StatCard
      title="Nedlastinger (30d)"
      value={stats?.downloads ?? 0}
      icon={<Download className="h-5 w-5" />}
    />
  </div>
)}
```

---

## T4: CUSTOM HOOKS

### File: `frontend/src/hooks/useTemplateSettings.ts`

Hook for loading and managing template settings.

```typescript
/**
 * Hook for template settings management
 */

import { useState, useEffect } from 'react';
import { templateSettingsApi } from '@/lib/api';
import type { UpdateTemplateSettingsResponse } from '@/types/v2';

interface UseTemplateSettingsReturn {
  settings: UpdateTemplateSettingsResponse | null;
  isLoading: boolean;
  error: string | null;
  refetch: () => void;
}

export function useTemplateSettings(templateId: string | null): UseTemplateSettingsReturn {
  const [settings, setSettings] = useState<UpdateTemplateSettingsResponse | null>(null);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchSettings = async () => {
    if (!templateId) return;

    setIsLoading(true);
    setError(null);

    try {
      const data = await templateSettingsApi.getSettings(templateId);
      setSettings(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Failed to load settings');
    } finally {
      setIsLoading(false);
    }
  };

  useEffect(() => {
    fetchSettings();
  }, [templateId]);

  return { settings, isLoading, error, refetch: fetchSettings };
}
```

### File: `frontend/src/hooks/useDashboardStats.ts`

Hook for dashboard statistics.

```typescript
/**
 * Hook for dashboard statistics
 */

import { useState, useEffect } from 'react';
import { dashboardApi } from '@/lib/api';
import type { DashboardStatsV2 } from '@/types/v2';

interface UseDashboardStatsReturn {
  stats: DashboardStatsV2 | null;
  isLoading: boolean;
  error: string | null;
  refetch: () => void;
}

export function useDashboardStats(): UseDashboardStatsReturn {
  const [stats, setStats] = useState<DashboardStatsV2 | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  const fetchStats = async () => {
    setIsLoading(true);
    setError(null);

    try {
      const data = await dashboardApi.getStats();
      setStats(data);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Failed to load stats');
    } finally {
      setIsLoading(false);
    }
  };

  useEffect(() => {
    fetchStats();
  }, []);

  return { stats, isLoading, error, refetch: fetchStats };
}
```

### File: `frontend/src/hooks/useGroupedTemplates.ts`

Hook for grouping templates into shelves.

```typescript
/**
 * Hook for grouping templates by various criteria
 */

import { useMemo } from 'react';
import type { TemplateWithMetadata, ShelfGroupBy, GroupedTemplates } from '@/types/v2';
import { FileText, Mail, MessageSquare, FolderOpen, CheckCircle, Clock } from 'lucide-react';

export function useGroupedTemplates(
  templates: TemplateWithMetadata[],
  groupBy: ShelfGroupBy
): GroupedTemplates {
  return useMemo(() => {
    const groups = new Map<string, TemplateWithMetadata[]>();

    // Group templates
    templates.forEach((template) => {
      let key: string;
      let label: string;

      switch (groupBy) {
        case 'channel':
          key = template.channel;
          label = getChannelLabel(template.channel);
          break;
        case 'category':
          key = template.categories[0]?.id || 'uncategorized';
          label = template.categories[0]?.name || 'Ukategorisert';
          break;
        case 'status':
          key = template.status;
          label = getStatusLabel(template.status);
          break;
        case 'phase':
          key = template.phases[0] || 'no-phase';
          label = template.phases[0] || 'Ingen fase';
          break;
        default:
          key = 'all';
          label = 'Alle maler';
      }

      if (!groups.has(key)) {
        groups.set(key, []);
      }
      groups.get(key)!.push(template);
    });

    // Convert to ShelfGroup array
    const shelfGroups = Array.from(groups.entries()).map(([id, templates]) => ({
      id,
      label: getLabelForGroup(id, groupBy),
      icon: getIconForGroup(id, groupBy),
      templates,
      isCollapsed: false,
    }));

    return {
      groups: shelfGroups,
      totalCount: templates.length,
    };
  }, [templates, groupBy]);
}

function getChannelLabel(channel: string): string {
  const labels: Record<string, string> = {
    pdf: 'PDF',
    email: 'E-post',
    sms: 'SMS',
    pdf_email: 'PDF & E-post',
  };
  return labels[channel] || channel;
}

function getStatusLabel(status: string): string {
  const labels: Record<string, string> = {
    published: 'Publisert',
    draft: 'Utkast',
    archived: 'Arkivert',
  };
  return labels[status] || status;
}

function getLabelForGroup(id: string, groupBy: ShelfGroupBy): string {
  switch (groupBy) {
    case 'channel':
      return getChannelLabel(id);
    case 'status':
      return getStatusLabel(id);
    default:
      return id;
  }
}

function getIconForGroup(id: string, groupBy: ShelfGroupBy): React.ReactNode {
  if (groupBy === 'channel') {
    const icons: Record<string, React.ReactNode> = {
      pdf: <FileText className="h-4 w-4" />,
      email: <Mail className="h-4 w-4" />,
      sms: <MessageSquare className="h-4 w-4" />,
      pdf_email: <FileText className="h-4 w-4" />,
    };
    return icons[id];
  }

  if (groupBy === 'status') {
    const icons: Record<string, React.ReactNode> = {
      published: <CheckCircle className="h-4 w-4" />,
      draft: <Clock className="h-4 w-4" />,
    };
    return icons[id];
  }

  return <FolderOpen className="h-4 w-4" />;
}
```

---

## T5: UI COMPONENTS

### File: `frontend/src/components/ui/toast.tsx`

Add toast component for notifications (using Shadcn).

```bash
npx shadcn-ui@latest add toast
```

### File: `frontend/src/hooks/use-toast.ts`

Toast hook (auto-generated by Shadcn).

---

## T6: FILE STRUCTURE ADDITIONS

```
frontend/
├── src/
│   ├── types/
│   │   └── v2.ts                           # NEW - V2.7 type definitions
│   ├── lib/
│   │   └── api/
│   │       ├── template-settings.ts        # NEW - Content & settings API
│   │       └── dashboard.ts                # NEW - Dashboard stats API
│   ├── hooks/
│   │   ├── useTemplateSettings.ts          # NEW - Settings management hook
│   │   ├── useDashboardStats.ts            # NEW - Dashboard stats hook
│   │   └── useGroupedTemplates.ts          # NEW - Shelf grouping hook
│   ├── components/
│   │   ├── ui/
│   │   │   └── toast.tsx                   # NEW - Toast notifications
│   │   ├── editor/
│   │   │   └── CodeEditor.tsx              # UPDATED - Add isSaving prop
│   │   └── templates/
│   │       ├── TemplateDetailSheet.tsx     # UPDATED - Wire up save
│   │       └── TemplateSettingsPanel.tsx   # UPDATED - Add isSaving prop
│   └── app/
│       └── page.tsx                        # UPDATED - Use real dashboard API
```

---

## T7: IMPLEMENTATION ORDER

### Phase 1: Type Definitions & API Clients (Priority: P0)
1. Create `frontend/src/types/v2.ts` with all type definitions
2. Create `frontend/src/lib/api/template-settings.ts`
3. Create `frontend/src/lib/api/dashboard.ts`
4. Update `frontend/src/lib/api.ts` to export new clients
5. Test: API clients can be imported without errors

### Phase 2: Custom Hooks (Priority: P0)
6. Create `frontend/src/hooks/useTemplateSettings.ts`
7. Create `frontend/src/hooks/useDashboardStats.ts`
8. Create `frontend/src/hooks/useGroupedTemplates.ts`
9. Test: Hooks can be used in components

### Phase 3: Toast Notifications (Priority: P0)
10. Install Shadcn toast component: `npx shadcn-ui@latest add toast`
11. Test: Toast can be triggered from components

### Phase 4: Code Editor Save (Priority: P0)
12. Update `CodeEditor.tsx` to add `isSaving` prop
13. Update `TemplateDetailSheet.tsx` to wire up save in Code tab
14. Test: Clicking Save in Code tab calls API and shows toast

### Phase 5: Settings Save (Priority: P1)
15. Update `TemplateSettingsPanel.tsx` to add `isSaving` prop
16. Update `TemplateDetailSheet.tsx` to wire up save in Settings tab
17. Test: Clicking Save in Settings tab calls API and shows toast

### Phase 6: Dashboard Integration (Priority: P1)
18. Update `frontend/src/app/page.tsx` to use `useDashboardStats` hook
19. Replace mock data with real API data
20. Test: Dashboard shows real statistics from backend

### Phase 7: Thumbnail Generation (Priority: P2)
21. Add "Generate Thumbnail" button to template card dropdown
22. Wire up button to call `templateSettingsApi.generateThumbnail`
23. Show success/error toast
24. Refetch template to show new thumbnail
25. Test: Thumbnail generation works (if Playwright installed)

---

## T8: COMPONENT PROPS REFERENCE

### CodeEditor

```typescript
interface CodeEditorProps {
  value: string;
  onChange: (value: string) => void;
  language?: string;
  theme?: string;
  onSave?: (value: string) => Promise<void>;
  isSaving?: boolean; // NEW in V2.7
}
```

### TemplateSettingsPanel

```typescript
interface TemplateSettingsPanelProps {
  templateId: string;
  onSave: (settings: TemplateSettings) => Promise<void>;
  isSaving?: boolean; // NEW in V2.7
}
```

### TemplateDetailSheet

```typescript
interface TemplateDetailSheetProps {
  template: Template | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onEdit?: (template: Template) => void;
  onDownload?: (template: Template) => void;
}
```

---

## T9: TEST CRITERIA

- [ ] Code tab Save button calls `PUT /api/templates/{id}/content`
- [ ] Code tab shows loading state while saving
- [ ] Code tab shows success toast after save
- [ ] Code tab shows error toast on failure
- [ ] Code tab reloads content after successful save
- [ ] Settings tab Save button calls `PUT /api/templates/{id}/settings`
- [ ] Settings tab shows loading state while saving
- [ ] Settings tab shows success toast after save
- [ ] Settings tab shows error toast on failure
- [ ] Dashboard fetches stats from `GET /api/dashboard/stats`
- [ ] Dashboard shows loading skeleton while fetching
- [ ] Dashboard shows error message on failure
- [ ] Dashboard displays real data in stat cards
- [ ] Thumbnail generation button calls `POST /api/templates/{id}/thumbnail`
- [ ] Thumbnail generation shows success/error toast
- [ ] Template card updates with new thumbnail after generation

---

## T10: ERROR HANDLING

### API Error Handling Pattern

All API calls should follow this pattern:

```typescript
try {
  const result = await apiCall();
  
  toast({
    title: "Success title",
    description: "Success message",
  });
  
  // Update local state or refetch data
} catch (error) {
  toast({
    title: "Error title",
    description: error instanceof Error ? error.message : "Generic error message",
    variant: "destructive",
  });
}
```

### Network Error Handling

```typescript
if (axios.isAxiosError(error)) {
  if (error.code === 'ERR_NETWORK') {
    toast({
      title: "Nettverksfeil",
      description: "Kan ikke koble til serveren. Sjekk at backend kjører.",
      variant: "destructive",
    });
  } else if (error.response?.status === 404) {
    toast({
      title: "Ikke funnet",
      description: "Malen finnes ikke.",
      variant: "destructive",
    });
  }
}
```

---

## T11: DEPENDENCIES

### NPM Packages (Already Installed)
- `axios` - HTTP client
- `@monaco-editor/react` - Code editor
- `date-fns` - Date formatting
- `lucide-react` - Icons
- `next` - Framework
- `react` - UI library
- `tailwindcss` - Styling

### Shadcn Components to Add
```bash
npx shadcn-ui@latest add toast
```

---

## HANDOFF TO BUILDER

The Builder agent should:
1. Create all new files in the order specified in T7
2. Update existing files with the changes specified in T3
3. Test each phase before moving to the next
4. Verify all test criteria in T9 are met
5. Ensure error handling follows the pattern in T10

**Key Files to Update:**
- `frontend/src/components/templates/TemplateDetailSheet.tsx` (wire up save)
- `frontend/src/components/editor/CodeEditor.tsx` (add isSaving prop)
- `frontend/src/components/templates/TemplateSettingsPanel.tsx` (add isSaving prop)
- `frontend/src/app/page.tsx` (use real dashboard API)

**Key Files to Create:**
- `frontend/src/types/v2.ts`
- `frontend/src/lib/api/template-settings.ts`
- `frontend/src/lib/api/dashboard.ts`
- `frontend/src/hooks/useTemplateSettings.ts`
- `frontend/src/hooks/useDashboardStats.ts`
- `frontend/src/hooks/useGroupedTemplates.ts`

---

**Next Step:** Invoke **BUILDER** agent to implement this specification.
