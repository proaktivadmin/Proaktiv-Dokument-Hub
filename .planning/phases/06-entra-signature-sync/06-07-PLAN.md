---
phase: 06-entra-signature-sync
plan: 07
type: execute
wave: 4
depends_on: [06-06]
files_modified:
  - frontend/src/components/employees/SignaturePreviewDialog.tsx
  - frontend/src/components/employees/EntraSyncDialog.tsx
  - frontend/src/components/employees/EntraSyncBatchDialog.tsx
  - frontend/src/components/employees/EntraConnectionStatus.tsx
autonomous: true
---

<objective>
Create UI components for signature preview and Entra ID sync operations.
</objective>

<tasks>
<task type="auto">
  <name>Task 1: Create Entra Connection Status Component</name>
  <files>frontend/src/components/employees/EntraConnectionStatus.tsx</files>
  <action>
    Small status indicator showing Entra ID connection:
    - Green dot + "Koblet til Entra ID" when connected
    - Red dot + "Ikke koblet" when disconnected
    - Warning if roaming signatures enabled
    - Similar to VitecConnectionStatus component
  </action>
</task>

<task type="auto">
  <name>Task 2: Create Signature Preview Dialog</name>
  <files>frontend/src/components/employees/SignaturePreviewDialog.tsx</files>
  <action>
    Dialog component showing:
    - Employee name and email header
    - Tabbed view: HTML Preview | Plain Text
    - HTML rendered in iframe or sanitized div
    - Plain text in pre/code block
    - "Push Signatur" button
    - Cancel button
    
    Props:
    - employeeId: string
    - open: boolean
    - onOpenChange: (open: boolean) => void
    - onPushSignature: () => void
  </action>
</task>

<task type="auto">
  <name>Task 3: Create Entra Sync Dialog (Single Employee)</name>
  <files>frontend/src/components/employees/EntraSyncDialog.tsx</files>
  <action>
    Dialog component for single employee sync:
    - Header with employee name and avatar
    - Preview section showing:
      - Entra user found/not found status
      - Table of property changes (current vs new)
      - Photo update status
      - Signature preview link
    - Scope checkboxes: Profile, Photo, Signature
    - Warning if roaming signatures enabled
    - "Synkroniser" button (primary)
    - "Forh√•ndsvis Signatur" button (secondary)
    - Cancel button
    - Loading states during sync
    - Success/error feedback
  </action>
</task>

<task type="auto">
  <name>Task 4: Create Entra Sync Batch Dialog</name>
  <files>frontend/src/components/employees/EntraSyncBatchDialog.tsx</files>
  <action>
    Dialog for batch sync operations:
    - Header: "Synkroniser X ansatte til Entra ID"
    - List of selected employees (scrollable, max height)
    - Scope checkboxes: Profile, Photo, Signature
    - Warning if roaming signatures enabled
    - Progress indicator during sync
    - Results summary: X successful, Y failed
    - Expandable error details
    - "Start Synkronisering" button
    - Cancel button (disabled during sync)
  </action>
</task>

<task type="auto">
  <name>Task 5: Export Components</name>
  <files>frontend/src/components/employees/index.ts</files>
  <action>
    Export new components from index file.
  </action>
</task>
</tasks>

<success_criteria>
- All dialogs render correctly
- Preview loads and displays diff
- Signature preview shows HTML properly
- Single sync works end-to-end
- Batch sync shows progress
- Error states handled gracefully
- Loading states provide feedback
</success_criteria>
