---
phase: 07-office-enhancements
plan: 07
type: execute
wave: 3
depends_on: [07-06, 07-02]
files_modified:
  - frontend/src/types/salesscreen.ts
  - frontend/src/lib/api/salesscreen.ts
  - frontend/src/hooks/useSalesScreen.ts
  - frontend/src/components/employees/SalesScreenSyncDialog.tsx
  - frontend/src/components/offices/OfficeForm.tsx
autonomous: true
---

<objective>
Create SalesScreen frontend types, API client, and UI components.
</objective>

<tasks>
<task type="auto">
  <name>Task 1: Create TypeScript Types</name>
  <files>frontend/src/types/salesscreen.ts</files>
  <action>
    Create types:
    ```typescript
    export interface SalesScreenUser {
      id?: string;
      email: string;
      firstName: string;
      lastName: string;
      title?: string;
      phone?: string;
      teamId?: string;
      photoUrl?: string;
    }
    
    export interface SalesScreenChange {
      field: string;
      current: string | null;
      new: string | null;
    }
    
    export interface SalesScreenSyncPreview {
      employee_id: string;
      employee_name: string;
      office_name: string;
      salesscreen_team_id: string | null;
      changes: SalesScreenChange[];
      can_sync: boolean;
      reason?: string;
    }
    
    export interface SalesScreenSyncRequest {
      employee_ids: string[];
      include_photo: boolean;
    }
    
    export interface SalesScreenSyncResult {
      employee_id: string;
      success: boolean;
      salesscreen_user_id?: string;
      error?: string;
    }
    
    export interface SalesScreenBatchResult {
      total: number;
      succeeded: number;
      failed: number;
      results: SalesScreenSyncResult[];
    }
    
    export interface SalesScreenConnectionStatus {
      connected: boolean;
      configured: boolean;
      error?: string;
    }
    ```
  </action>
</task>

<task type="auto">
  <name>Task 2: Create API Client</name>
  <files>frontend/src/lib/api/salesscreen.ts</files>
  <action>
    Create API client:
    ```typescript
    import { api } from './config';
    import type {
      SalesScreenConnectionStatus,
      SalesScreenSyncPreview,
      SalesScreenSyncRequest,
      SalesScreenSyncResult,
      SalesScreenBatchResult,
    } from '@/types/salesscreen';
    
    export const salesscreenApi = {
      getStatus: () => 
        api.get<SalesScreenConnectionStatus>('/salesscreen/status'),
      
      getPreview: (employeeId: string) =>
        api.get<SalesScreenSyncPreview>(`/salesscreen/preview/${employeeId}`),
      
      syncEmployee: (employeeId: string, includePhoto = true) =>
        api.post<SalesScreenSyncResult>(
          `/salesscreen/sync/${employeeId}?include_photo=${includePhoto}`
        ),
      
      syncBatch: (request: SalesScreenSyncRequest) =>
        api.post<SalesScreenBatchResult>('/salesscreen/sync/batch', request),
    };
    ```
  </action>
</task>

<task type="auto">
  <name>Task 3: Create React Hook</name>
  <files>frontend/src/hooks/useSalesScreen.ts</files>
  <action>
    Create hook:
    ```typescript
    import { useState, useCallback } from 'react';
    import { salesscreenApi } from '@/lib/api/salesscreen';
    import type {
      SalesScreenConnectionStatus,
      SalesScreenSyncPreview,
      SalesScreenSyncResult,
      SalesScreenBatchResult,
    } from '@/types/salesscreen';
    
    export function useSalesScreen() {
      const [status, setStatus] = useState<SalesScreenConnectionStatus | null>(null);
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState<string | null>(null);
      
      const checkStatus = useCallback(async () => {
        setIsLoading(true);
        try {
          const result = await salesscreenApi.getStatus();
          setStatus(result);
          return result;
        } catch (err) {
          setError(err instanceof Error ? err.message : 'Connection failed');
          return null;
        } finally {
          setIsLoading(false);
        }
      }, []);
      
      const getPreview = useCallback(async (employeeId: string) => {
        setIsLoading(true);
        setError(null);
        try {
          return await salesscreenApi.getPreview(employeeId);
        } catch (err) {
          setError(err instanceof Error ? err.message : 'Preview failed');
          return null;
        } finally {
          setIsLoading(false);
        }
      }, []);
      
      const syncEmployee = useCallback(async (
        employeeId: string,
        includePhoto = true
      ): Promise<SalesScreenSyncResult | null> => {
        setIsLoading(true);
        setError(null);
        try {
          return await salesscreenApi.syncEmployee(employeeId, includePhoto);
        } catch (err) {
          setError(err instanceof Error ? err.message : 'Sync failed');
          return null;
        } finally {
          setIsLoading(false);
        }
      }, []);
      
      const syncBatch = useCallback(async (
        employeeIds: string[],
        includePhoto = true
      ): Promise<SalesScreenBatchResult | null> => {
        setIsLoading(true);
        setError(null);
        try {
          return await salesscreenApi.syncBatch({ 
            employee_ids: employeeIds, 
            include_photo: includePhoto 
          });
        } catch (err) {
          setError(err instanceof Error ? err.message : 'Batch sync failed');
          return null;
        } finally {
          setIsLoading(false);
        }
      }, []);
      
      return {
        status,
        isLoading,
        error,
        checkStatus,
        getPreview,
        syncEmployee,
        syncBatch,
      };
    }
    ```
  </action>
</task>

<task type="auto">
  <name>Task 4: Create SalesScreen Sync Dialog</name>
  <files>frontend/src/components/employees/SalesScreenSyncDialog.tsx</files>
  <action>
    Create dialog similar to EntraSyncDialog:
    - Shows sync preview with changes
    - Checkbox: "Include photo"
    - Shows office/team mapping
    - Error if office not enabled
    - Confirm button to execute sync
    - Success/error toast
  </action>
</task>

<task type="auto">
  <name>Task 5: Add SalesScreen Toggle to OfficeForm</name>
  <files>frontend/src/components/offices/OfficeForm.tsx</files>
  <action>
    Add to Integrations tab (or create new tab):
    ```tsx
    <FormField
      control={form.control}
      name="salesscreen_enabled"
      render={({ field }) => (
        <FormItem className="flex items-center justify-between">
          <div>
            <FormLabel>SalesScreen</FormLabel>
            <FormDescription>
              Enable employee sync to SalesScreen
            </FormDescription>
          </div>
          <FormControl>
            <Switch
              checked={field.value}
              onCheckedChange={field.onChange}
            />
          </FormControl>
        </FormItem>
      )}
    />
    
    {form.watch("salesscreen_enabled") && (
      <FormField
        control={form.control}
        name="salesscreen_team_id"
        render={({ field }) => (
          <FormItem>
            <FormLabel>SalesScreen Team ID</FormLabel>
            <FormControl>
              <Input {...field} placeholder="e.g., team-123" />
            </FormControl>
            <FormDescription>
              Team ID from SalesScreen admin panel
            </FormDescription>
          </FormItem>
        )}
      />
    )}
    ```
  </action>
</task>
</tasks>

<success_criteria>
- Types match backend schemas
- API client works with backend
- Hook provides sync operations
- Dialog shows preview and executes sync
- Office form has SalesScreen toggle
- Disabled offices show appropriate message
</success_criteria>
