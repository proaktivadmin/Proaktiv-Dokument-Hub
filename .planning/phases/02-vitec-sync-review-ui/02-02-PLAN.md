---
phase: 02-vitec-sync-review-ui
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - backend/app/models/sync_session.py
  - backend/app/services/sync_preview_service.py
  - backend/app/routers/sync.py
  - backend/app/main.py
autonomous: true
---

<objective>
Build preview endpoint that fetches Vitec data, generates diffs, and stores in a sync session for later review/commit.
</objective>

<tasks>
<task type="auto">
  <name>Task 1: Create SyncSession model</name>
  <files>backend/app/models/sync_session.py</files>
  <action>Create SQLAlchemy model with id, preview_data (JSONB), decisions (JSONB), status, created_at, expires_at.</action>
</task>

<task type="auto">
  <name>Task 2: Create database migration</name>
  <files>backend/alembic/versions/</files>
  <action>Create migration for sync_sessions table.</action>
</task>

<task type="auto">
  <name>Task 3: Create preview service</name>
  <files>backend/app/services/sync_preview_service.py</files>
  <action>Create SyncPreviewService with generate_preview() that fetches Vitec data, creates diffs, stores session.</action>
</task>

<task type="auto">
  <name>Task 4: Create sync router</name>
  <files>backend/app/routers/sync.py, backend/app/main.py</files>
  <action>Create router with POST /api/sync/preview, GET /api/sync/sessions/{id}, DELETE /api/sync/sessions/{id}.</action>
</task>
</tasks>

<success_criteria>
- POST /api/sync/preview returns SyncPreview with session_id
- Session stored in database
- GET /api/sync/sessions/{id} retrieves session
</success_criteria>
